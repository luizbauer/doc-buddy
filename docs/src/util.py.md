[<< Table of Contents](../index.md)

# AI Generated documentation for `doc-buddy/src/util.py`
---
# File: src/util.py

This module provides utility functions for the `doc-buddy` project, handling file operations and AI provider initialization.

## Functions

### `get_absolute_path(file_path: str)`

This function resolves the absolute path of a given file path. It considers the `USER_CWD` environment variable. If `USER_CWD` is set, it uses this as the base directory; otherwise, it resolves the path relative to the current working directory. This ensures consistent path resolution regardless of execution context.

**Parameters:**

* `file_path (str)`: The file path to resolve.

**Returns:**

* `Path`: The absolute path of the file.


### `read_file(file_path: str, dry_run=False)`

Reads and prints the content of a file.  It incorporates a `dry_run` flag for testing purposes. When `dry_run` is True, the function only prints the absolute path it *would* have read without actually reading the file's content. This is helpful for debugging and verifying file paths before execution.

**Parameters:**

* `file_path (str)`: The path to the file to read.
* `dry_run (bool, optional)`: If True, simulates reading the file without actually opening it. Defaults to False.


### `initialize_provider()`

Initializes the AI provider based on the `AI_PROVIDER` environment variable. It supports "GOOGLE-GEMINI", "GOOGLE-VERTEXAI", and "OPENAI". The function checks the environment variable and instantiates the corresponding provider class. If the environment variable is not set or contains an invalid provider name, it prints an error and exits the program.

**Returns:**

* An instance of the chosen AI provider (e.g., `OpenAIProvider`, `GoogleGenAIProvider`, `VertexAIProvider`).  Returns `None` and exits the program if the provider is not found.



## Module Logic

The module leverages the `pathlib` library for path manipulation, making it OS-independent. It also interacts with environment variables to determine the user's preferred working directory (`USER_CWD`) and the desired AI provider (`AI_PROVIDER`).  The separation of concerns (file handling, AI provider initialization) makes the code more modular and maintainable. Error handling is implemented to gracefully handle file not found errors and invalid AI provider specifications.

# Full listing of src/util.py
```python
"""
This module contains utility functions that are used by the main script.
"""

import os
import sys
from pathlib import Path
from ai_provider.open_ai_provider import OpenAIProvider
from ai_provider.google_gen_ai_provider import GoogleGenAIProvider
from ai_provider.vertexai_ai_provider import VertexAIProvider


def get_absolute_path(file_path: str):
    """
    Returns the absolute path of the file, taking into account the USER_CWD
    environment variable.  If USER_CWD is set, it uses that as the base
    directory; otherwise, it resolves the file path from the current working
    directory.
    """
    user_cwd = os.getenv("USER_CWD")

    if user_cwd:
        base_path = Path(user_cwd).resolve()
        absolute_path = (base_path / file_path).resolve()
    else:
        absolute_path = Path(file_path).resolve()

    return absolute_path


def read_file(file_path: str, dry_run=False):
    """
    Reads the content of the file at the given path.
    If the dry_run flag is set, it only prints the file path and does not read the file.
    """
    # Get the absolute path using the separate function
    absolute_path = get_absolute_path(file_path)

    if dry_run:
        print(f"Dry run: Would read file '{absolute_path}'")
        return

    try:
        with open(absolute_path, "r", encoding="utf-8") as file:
            content = file.read()
            print(content)

    except FileNotFoundError:
        print(f"Error: File '{absolute_path}' not found.")
    except Exception as e:
        print(f"Error: {e}")


def initialize_provider():
    """
    Initialize the AI provider.
    """

    provider_name = os.getenv("AI_PROVIDER").upper()

    # should work uppercase and lowercase, convert to uppercase
    if provider_name == "GOOGLE-GEMINI":
        print("-> Using Google Gemini AI provider")
        provider = GoogleGenAIProvider()

    elif provider_name == "GOOGLE-VERTEXAI":
        print("-> Using Google Vertex AI provider")
        provider = VertexAIProvider()

    elif provider_name == "OPENAI":
        print("-> Using OpenAI provider")
        provider = OpenAIProvider()

    else:
        print("Error: AI provider not found.")
        sys.exit(1)

    return provider

```
<br>
<br>


---
### Automatically generated Documentation for `doc-buddy/src/util.py`
This documentation is generated automatically from the source code. Do not edit this file directly.
Generated by **Doc-Buddy** on **November 09, 2024 19:46:23** via **gemini-1.5-pro-002**

For more information, visit the [Doc-Buddy on GitHub](https://github.com/scott-r-lindsey/doc-buddy).  
*doc-buddy Commit Hash: b01f9573f01b626efe9b415f7392e374029af615*
