[<< Table of Contents](../../index.md)

# AI Generated documentation for `doc-buddy/src/process/project_to_text.py`
---
This document describes the Python script `project_to_text.py` within the `doc-buddy` project.  This script aims to extract textual content from various file types within a given project directory.  It supports a range of file extensions and uses different libraries for extraction based on the file type.

The script begins by importing necessary libraries: `os`, `sys`, `argparse`, `docx`, `PyPDF2`, and `openpyxl`.

**Function: `process_file(filepath)`**

This function is the core of the script. It takes a file path as input and returns the extracted text content as a string.  It first determines the file's extension using `os.path.splitext()`. Then, based on the extension, it uses the appropriate library to extract the text:

* **`.docx` (Microsoft Word):** Uses the `docx` library to iterate through paragraphs and runs within the document, extracting text.
* **`.pdf` (Portable Document Format):** Uses the `PyPDF2` library to extract text from each page of the PDF.
* **`.xlsx` and `.xls` (Microsoft Excel):** Uses the `openpyxl` library to iterate through all cells in all sheets of the Excel file, extracting the cell values.
* **`.txt` (Plain Text):** Simply reads the file content directly.
* **Other extensions:** Returns an empty string, effectively skipping unsupported file types.

**Function: `process_directory(directory)`**

This function takes a directory path as input and processes all files within that directory and its subdirectories.  It uses `os.walk()` to traverse the directory tree. For each file found, it calls `process_file()` to extract the text.  The extracted text from all files is concatenated into a single string and returned.

**Main Execution Block**

The main part of the script uses the `argparse` library to handle command-line arguments.  It defines a required argument `-d` or `--directory` to specify the project directory.  It then parses the provided arguments.

If the specified directory exists, it calls `process_directory()` to extract text from all supported files within the directory. The extracted text is then printed to the console. If the directory doesn't exist, an error message is printed.

In summary, this script provides a simple way to extract text content from a variety of file types within a project directory. It's designed to be used from the command line, taking the project directory as input.  The extracted text is then output to the console, which can be further processed or used by other tools.

# Full listing of src/process/project_to_text.py
```python

```
<br>
<br>


---
### Automatically generated Documentation for `doc-buddy/src/process/project_to_text.py`
This documentation is generated automatically from the source code. Do not edit this file directly.
Generated by **Doc-Buddy** on **November 09, 2024 19:46:12** via **gemini-1.5-pro-002**

For more information, visit the [Doc-Buddy on GitHub](https://github.com/scott-r-lindsey/doc-buddy).  
*doc-buddy Commit Hash: b01f9573f01b626efe9b415f7392e374029af615*
